<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1"
  />
  <title>Project DermaScope â€” Sign up</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
    rel="stylesheet"
  />

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#eef2ff',
              100: '#e0e7ff',
              200: '#c7d2fe',
              300: '#a5b4fc',
              400: '#818cf8',
              500: '#6366f1',
              600: '#4f46e5',
              700: '#4338ca',
              800: '#3730a3',
              900: '#312e81'
            }
          },
          boxShadow: {
            'brand': '0 10px 35px rgba(99, 102, 241, 0.25)'
          },
          animation: {
            'float-slow': 'float 8s ease-in-out infinite',
            'pulse-slow': 'pulse 3s ease-in-out infinite'
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-8px)' }
            }
          }
        }
      }
    };
  </script>

  <style>
    html, body { height: 100%; }
    body {
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
    }
    .bg-decor {
      background:
        radial-gradient(1000px 600px at -10% -10%, rgba(99,102,241,0.20), transparent 60%),
        radial-gradient(900px 500px at 110% 10%, rgba(236,72,153,0.18), transparent 60%),
        radial-gradient(800px 500px at 50% 120%, rgba(34,197,94,0.16), transparent 60%),
        linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
      position: relative;
      min-height: 100%;
    }
    .noise-overlay:before {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0.05;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="260" height="260" viewBox="0 0 260 260"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.35"/></svg>');
      background-size: 300px 300px;
    }
    .glass {
      background: rgba(255, 255, 255, 0.78);
      backdrop-filter: saturate(1.4) blur(10px);
      -webkit-backdrop-filter: saturate(1.4) blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.6);
    }
    .focus-ring { outline: 2px solid transparent; outline-offset: 2px; }
    .focus-ring:focus-visible { box-shadow: 0 0 0 4px rgba(99,102,241,0.35); }
  </style>
</head>

<body class="bg-decor noise-overlay antialiased text-slate-800">
  <!-- Decorative orbs -->
  <div aria-hidden="true" class="pointer-events-none absolute -top-24 -left-24 w-72 h-72 rounded-full bg-brand-300 opacity-30 blur-3xl animate-float-slow"></div>
  <div aria-hidden="true" class="pointer-events-none absolute -bottom-24 -right-24 w-80 h-80 rounded-full bg-pink-300 opacity-30 blur-3xl animate-float-slow" style="animation-delay: 1s;"></div>

  <main class="relative min-h-screen flex items-center justify-center px-4">
    <section class="w-full max-w-md">
      <!-- Brand -->
      <div class="mb-6 text-center">
        <div class="inline-flex items-center gap-3">
          <span class="inline-flex h-10 w-10 items-center justify-center rounded-xl bg-brand-600 text-white shadow-brand">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5.5 w-5.5" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2a8 8 0 0 0-8 8v3.586l-1.707 1.707A1 1 0 0 0 3 17h4a1 1 0 0 0 1-1v-2a4 4 0 1 1 8 0v2a1 1 0 0 0 1 1h4a1 1 0 0 0 .707-1.707L20 13.586V10a8 8 0 0 0-8-8Z"/>
              <path d="M8 19a4 4 0 0 0 8 0h-2a2 2 0 1 1-4 0H8Z"/>
            </svg>
          </span>
          <div class="text-left">
            <div class="text-xs uppercase tracking-widest text-slate-500">Project DermaScope</div>
            <div class="text-xl font-extrabold tracking-tight text-slate-900">Create account</div>
          </div>
        </div>
        <p class="mt-2 text-sm text-slate-600">Sign up to start using Project DermaScope.</p>
      </div>

      <!-- Card -->
      <div class="glass rounded-2xl p-6 shadow-xl ring-1 ring-slate-200">
        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <div class="mb-4 rounded-lg bg-amber-50 border border-amber-200 px-4 py-3 text-sm text-amber-800">
              {% for message in messages %}
                <div>{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        {% if error %}
          <div class="mb-4 rounded-lg bg-red-50 border border-red-200 px-4 py-3 text-sm text-red-700">
            {{ error }}
          </div>
        {% endif %}

        <form action="{{ url_for('register') }}" method="POST" class="space-y-4" id="registerForm" novalidate>
          <!-- Username -->
          <div>
            <label for="username" class="block text-sm font-medium text-slate-700 mb-1">Username</label>
            <div class="relative">
              <input
                id="username"
                name="username"
                type="text"
                inputmode="text"
                autocomplete="username"
                placeholder="Choose a username"
                required
                class="w-full rounded-xl border border-slate-300 bg-white/80 px-3.5 py-2.5 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm focus-ring"
              />
              <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-slate-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4.5 w-4.5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-3.33 0-10 1.667-10 5v1h20v-1c0-3.333-6.67-5-10-5Z"/>
                </svg>
              </div>
            </div>
          </div>

          <!-- Password -->
          <div>
            <label for="password" class="block text-sm font-medium text-slate-700 mb-1">Password</label>
            <div class="relative">
              <input
                id="password"
                name="password"
                type="password"
                autocomplete="new-password"
                placeholder="Create a password"
                required
                minlength="6"
                class="w-full rounded-xl border border-slate-300 bg-white/80 px-3.5 py-2.5 pr-10 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm focus-ring"
                aria-describedby="pwHelp pwMeterText"
              />
              <button
                type="button"
                id="togglePw"
                class="absolute inset-y-0 right-2.5 my-auto inline-flex h-8 w-8 items-center justify-center rounded-md text-slate-500 hover:text-slate-700 hover:bg-slate-100 focus-ring"
                aria-label="Show password"
              >
                <svg id="eyeOpen" xmlns="http://www.w3.org/2000/svg" class="h-4.5 w-4.5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7Zm0 12a5 5 0 1 1 5-5 5.006 5.006 0 0 1-5 5Zm0-8a3 3 0 1 0 3 3 3 3 0 0 0-3-3Z"/>
                </svg>
                <svg id="eyeClosed" xmlns="http://www.w3.org/2000/svg" class="hidden h-4.5 w-4.5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M3.28 2.22 2.22 3.28 6.2 7.26A12.8 12.8 0 0 0 1 12c1.73 3.89 6 7 11 7a11.9 11.9 0 0 0 6.39-1.86l3.33 3.33 1.06-1.06L3.28 2.22ZM12 17c-4.42 0-7.93-2.77-9.58-5 1.02-1.48 2.79-3 5-3.87l2.02 2.02A4.996 4.996 0 0 0 12 17Zm1.42-3.58 2.18 2.18A4.98 4.98 0 0 0 17 12a5 5 0 0 0-.3-1.7l3.06-3.06C22.3 8.05 23 10.04 23 12c-1.73 3.89-6 7-11 7a11.9 11.9 0 0 1-3.64-.59l2.06-2.06A5 5 0 0 0 17 12c0-.56-.1-1.09-.28-1.58l-3.3 3.3Z"/>
                </svg>
              </button>
            </div>
            <!-- Strength meter -->
            <div class="mt-2">
              <div class="h-1.5 w-full rounded-full bg-slate-200 overflow-hidden">
                <div id="pwMeterBar" class="h-full w-0 rounded-full transition-all duration-300"></div>
              </div>
              <div id="pwMeterText" class="mt-1 text-xs text-slate-500">Use 6+ characters (mix of letters, numbers, symbols).</div>
            </div>
          </div>

          <!-- Confirm Password -->
          <div>
            <label for="confirm_password" class="block text-sm font-medium text-slate-700 mb-1">Confirm password</label>
            <div class="relative">
              <input
                id="confirm_password"
                name="confirm_password"
                type="password"
                autocomplete="new-password"
                placeholder="Re-enter your password"
                required
                class="w-full rounded-xl border border-slate-300 bg-white/80 px-3.5 py-2.5 pr-10 text-sm text-slate-900 placeholder:text-slate-400 shadow-sm focus-ring"
              />
              <button
                type="button"
                id="toggleCpw"
                class="absolute inset-y-0 right-2.5 my-auto inline-flex h-8 w-8 items-center justify-center rounded-md text-slate-500 hover:text-slate-700 hover:bg-slate-100 focus-ring"
                aria-label="Show password"
              >
                <svg id="eyeOpen2" xmlns="http://www.w3.org/2000/svg" class="h-4.5 w-4.5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7Zm0 12a5 5 0 1 1 5-5 5.006 5.006 0 0 1-5 5Zm0-8a3 3 0 1 0 3 3 3 3 0 0 0-3-3Z"/>
                </svg>
                <svg id="eyeClosed2" xmlns="http://www.w3.org/2000/svg" class="hidden h-4.5 w-4.5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M3.28 2.22 2.22 3.28 6.2 7.26A12.8 12.8 0 0 0 1 12c1.73 3.89 6 7 11 7a11.9 11.9 0 0 0 6.39-1.86l3.33 3.33 1.06-1.06L3.28 2.22ZM12 17c-4.42 0-7.93-2.77-9.58-5 1.02-1.48 2.79-3 5-3.87l2.02 2.02A4.996 4.996 0 0 0 12 17Zm1.42-3.58 2.18 2.18A4.98 4.98 0 0 0 17 12a5 5 0 0 0-.3-1.7l3.06-3.06C22.3 8.05 23 10.04 23 12c-1.73 3.89-6 7-11 7a11.9 11.9 0 0 1-3.64-.59l-2.06-2.06A5 5 0 0 0 17 12c0-.56-.1-1.09-.28-1.58l-3.3 3.3Z"/>
                </svg>
              </button>
            </div>
            <p id="matchMsg" class="mt-1 text-xs" aria-live="polite"></p>
          </div>

          <!-- Submit -->
          <div class="pt-1">
            <button
              type="submit"
              id="registerBtn"
              class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-brand-600 px-4 py-2.5 text-sm font-semibold text-white shadow-brand hover:bg-brand-700 transition disabled:opacity-50 disabled:cursor-not-allowed focus-ring"
              disabled
            >
              <svg id="spinner" class="hidden animate-spin h-4 w-4 text-white" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 0 1 8-8v3a5 5 0 0 0-5 5H4z"></path>
              </svg>
              <span id="btnText">Create account</span>
            </button>
          </div>
        </form>

        <div class="mt-5 text-center text-sm">
          <span class="text-slate-600">Already have an account?</span>
          <a href="{{ url_for('login') }}" class="ml-1 font-semibold text-brand-700 hover:text-brand-800 underline underline-offset-4 decoration-brand-300">
            Sign in
          </a>
        </div>
      </div>

      <!-- Subtle footer -->
      <p class="mt-6 text-center text-xs text-slate-500">
        &copy; <span id="year"></span> Project DermaScope. All rights reserved.
      </p>
    </section>
  </main>

  <script>
    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    const form = document.getElementById('registerForm');
    const user = document.getElementById('username');
    const pw = document.getElementById('password');
    const cpw = document.getElementById('confirm_password');
    const btn = document.getElementById('registerBtn');
    const btnText = document.getElementById('btnText');
    const spinner = document.getElementById('spinner');
    const matchMsg = document.getElementById('matchMsg');

    const togglePw = document.getElementById('togglePw');
    const eyeOpen = document.getElementById('eyeOpen');
    const eyeClosed = document.getElementById('eyeClosed');
    const toggleCpw = document.getElementById('toggleCpw');
    const eyeOpen2 = document.getElementById('eyeOpen2');
    const eyeClosed2 = document.getElementById('eyeClosed2');

    const meterBar = document.getElementById('pwMeterBar');
    const meterText = document.getElementById('pwMeterText');

    function scorePassword(p) {
      let s = 0;
      if (!p) return 0;
      const rules = [
        /.{6,}/,        // length
        /[a-z]/,        // lower
        /[A-Z]/,        // upper
        /\d/,           // number
        /[^A-Za-z0-9]/  // symbol
      ];
      rules.forEach(r => { if (r.test(p)) s++; });
      // Bonus for 10+ length
      if (p.length >= 10) s++;
      return Math.min(s, 5);
    }

    function updateMeter() {
      const s = scorePassword(pw.value);
      const pct = [0, 25, 45, 65, 85, 100][s];
      meterBar.style.width = pct + '%';
      let color = '#e11d48'; // red-600
      let label = 'Very weak';
      if (s >= 4) { color = '#16a34a'; label = 'Strong'; }      // green-600
      else if (s === 3) { color = '#ca8a04'; label = 'Medium'; } // yellow-600
      else if (s === 2) { color = '#f59e0b'; label = 'Fair'; }   // amber-500
      meterBar.style.backgroundColor = color;
      meterText.textContent = pw.value ? `Password strength: ${label}` : 'Use 6+ characters (mix of letters, numbers, symbols).';
    }

    function validate() {
      const uOK = user.value.trim().length > 0;
      const pOK = pw.value.trim().length >= 6;
      const match = pw.value === cpw.value && pw.value.length > 0;

      matchMsg.textContent = '';
      matchMsg.classList.remove('text-red-600', 'text-emerald-600');
      if (cpw.value.length) {
        if (match) {
          matchMsg.textContent = 'Passwords match';
          matchMsg.classList.add('text-emerald-600');
        } else {
          matchMsg.textContent = 'Passwords do not match';
          matchMsg.classList.add('text-red-600');
        }
      }

      btn.disabled = !(uOK && pOK && match);
    }

    user.addEventListener('input', validate);
    pw.addEventListener('input', () => { updateMeter(); validate(); });
    cpw.addEventListener('input', validate);

    // Initial state
    updateMeter();
    validate();

    // Toggle password visibility
    togglePw.addEventListener('click', () => {
      const isPwd = pw.type === 'password';
      pw.type = isPwd ? 'text' : 'password';
      togglePw.setAttribute('aria-label', isPwd ? 'Hide password' : 'Show password');
      eyeOpen.classList.toggle('hidden', !isPwd);
      eyeClosed.classList.toggle('hidden', isPwd);
    });
    toggleCpw.addEventListener('click', () => {
      const isPwd = cpw.type === 'password';
      cpw.type = isPwd ? 'text' : 'password';
      toggleCpw.setAttribute('aria-label', isPwd ? 'Hide password' : 'Show password');
      eyeOpen2.classList.toggle('hidden', !isPwd);
      eyeClosed2.classList.toggle('hidden', isPwd);
    });

    // Loading state
    form.addEventListener('submit', () => {
      btn.disabled = true;
      spinner.classList.remove('hidden');
      btnText.textContent = 'Creating...';
    });
  </script>
</body>
</html>